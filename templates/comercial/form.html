<div class="space-y-6 animate-fade-in-down">
    <div class="flex justify-between items-center">
        <h2 class="text-2xl font-bold text-[#123456]">Nueva Solicitud Comercial</h2>
        <span class="text-sm text-gray-500">Paso 1 de 2: Datos del Proyecto</span>
    </div>

    <form hx-post="/comercial/form" hx-target="#main-content" hx-swap="innerHTML"
        hx-disabled-elt="#submit-btn, #cancel-btn"
        class="space-y-6 bg-white p-6 rounded-lg shadow-md border-t-4 border-[#123456]">

        <div>
            <h3 class="text-lg font-semibold text-[#123456] mb-3 border-b pb-1">Datos Generales</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-[#262626]">Nombre del Cliente *</label>
                    <input type="text" name="nombre_cliente" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#00BABB] focus:ring-[#00BABB] sm:text-sm p-2 border"
                        placeholder="Ej. AMAZON MXICO">
                </div>
                <div>
                    <label class="block text-sm font-medium text-[#262626]">Nombre del Proyecto *</label>
                    <input type="text" name="nombre_proyecto" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#00BABB] focus:ring-[#00BABB] sm:text-sm p-2 border"
                        placeholder="Ej. CEDIS TEPOTZOTLAN">
                </div>
                <div>
                    <label class="block text-sm font-medium text-[#262626]">Canal de Venta *</label>
                    <input type="text" name="canal_venta" required value="{{ canal_default }}"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#00BABB] focus:ring-[#00BABB] sm:text-sm p-2 border">
                </div>
            </div>
        </div>

        <div>
            <h3 class="text-lg font-semibold text-[#123456] mb-3 border-b pb-1">Especificaciones</h3>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label class="block text-sm font-medium text-[#262626]">Tecnolog铆a *</label>
                    <div class="relative">
                        <select name="id_tecnologia" required
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-[#00BABB] focus:border-transparent">
                            <option value="" disabled selected>Seleccione una tecnolog铆a...</option>

                            {% for tec in catalogos.tecnologias %}
                            <option value="{{ tec.id }}">{{ tec.nombre }}</option>
                            {% endfor %}

                        </select>
                        <div
                            class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                                <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                            </svg>
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-[#262626]">Tipo de Solicitud *</label>
                    <div class="relative">
                        <select name="id_tipo_solicitud" required
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-[#00BABB] focus:border-transparent">
                            <option value="" disabled selected>Seleccione el tipo...</option>

                            {% for tipo in catalogos.tipos_solicitud %}
                            <option value="{{ tipo.id }}">{{ tipo.nombre }}</option>
                            {% endfor %}

                        </select>
                        <div
                            class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                                <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                            </svg>
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-[#262626]">Cant. Sitios *</label>
                    <input type="number" name="cantidad_sitios" value="1" min="1" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#00BABB] focus:ring-[#00BABB] sm:text-sm p-2 border">
                    <p class="text-xs text-gray-500 mt-1">Requiere confirmaci贸n en Paso 2</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Prioridad</label>
                    <select name="prioridad"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                        <option value="normal">Normal</option>
                        <option value="low">Baja</option>
                        <option value="high">Alta</option>
                    </select>
                </div>
            </div>
        </div>

        <div>
            <h3 class="text-lg font-semibold text-[#123456] mb-3 border-b pb-1">Ubicaci贸n y Referencias</h3>
            <div class="grid grid-cols-1 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Direcci贸n (Obligatorio)</label>
                    <input type="text" name="direccion_obra" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-blue-700">Link Google Maps (Obligatorio)</label>
                        <input type="text" name="google_maps_link" required
                            placeholder="Pegar link o texto de ubicaci贸n"
                            class="mt-1 block w-full rounded-md border-blue-200 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border text-blue-800">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Coordenadas GPS</label>
                        <input type="text" name="coordenadas_gps" placeholder="Ej: 19.4326, -99.1332"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Link Carpeta SharePoint (Opcional)</label>
                    <div class="mt-1 flex rounded-md shadow-sm">
                        <span
                            class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">
                            
                        </span>
                        <input type="url" name="sharepoint_folder_url"
                            class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-r-md border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm border"
                            placeholder="https://enertika.sharepoint.com/...">
                    </div>
                </div>
            </div>
        </div>

        <div class="flex justify-end pt-4 items-center gap-3">

            <!-- Spinner separado -->
            <div id="loading-indicator" class="htmx-indicator flex items-center gap-2 text-blue-600">
                <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                    </path>
                </svg>
                <span class="text-sm font-medium">Guardando...</span>
            </div>

            <button type="button" hx-get="/comercial/ui" hx-target="#main-content" hx-swap="innerHTML"
                hx-push-url="true"
                class="text-gray-500 hover:text-gray-700 px-3 py-1.5 text-sm font-medium disabled:opacity-50"
                id="cancel-btn">
                Cancelar
            </button>

            <button type="submit" id="submit-btn" hx-indicator="#loading-indicator" hx-disabled-elt="this"
                class="px-4 py-2 border border-transparent rounded-lg shadow-md shadow-[#00BABB]/20 text-sm font-bold text-white bg-[#00BABB] hover:bg-[#009999] focus:ring-2 focus:ring-offset-2 focus:ring-[#00BABB] flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:scale-105">
                <span>Guardar y Continuar</span>
            </button>
        </div>
    </form>
</div>