<div class="p-4">
    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
        <span class="text-blue-500">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z">
                </path>
            </svg>
        </span>
        <span>Historial de Comentarios</span>
    </h3>

    {% if comentarios %}
    <div class="space-y-3 max-h-96 overflow-y-auto">
        {% for comentario in comentarios %}
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 hover:shadow-sm transition">
            <div class="flex justify-between items-start mb-2">
                <span class="text-xs font-semibold text-blue-600">{{ comentario.usuario_email }}</span>
                <span class="text-xs text-gray-500">{{ comentario.fecha_comentario | time_mx }}</span>
            </div>
            {% if comentario.etapa %}
            <div class="mb-1">
                <span
                    class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800">
                    {{ comentario.etapa }}
                </span>
            </div>
            {% endif %}
            <p class="text-sm text-gray-700 whitespace-pre-wrap">{{ comentario.comentario }}</p>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-8 text-gray-500">
        <p class="text-2xl mb-2 text-gray-400">
            <svg class="w-10 h-10 inline opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4">
                </path>
            </svg>
        </p>
        <p class="text-sm">No hay comentarios registrados</p>
    </div>
    {% endif %}
</div>